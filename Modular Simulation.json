{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Uncategorized",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "import platform\nimport uuid",
            "description": "",
            "joint": {
                "cells": [
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "ca77dad4-b6c1-4e8f-b11a-c021efca928c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d6141597-15a3-451a-ae6c-79bd83d15550",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d10b425d-717c-478a-8fe3-c484a18ff770",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 26
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6071b2c3-e5ff-4b90-9cbf-19659acce3dc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "21ef810d-17ff-4190-a30b-49982453db83",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 41
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "985dd52c-63fd-4fce-b409-654135c2933d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "72c21228-914b-4963-94af-3d781c321f39",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d6141597-15a3-451a-ae6c-79bd83d15550",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 74
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "91f6fe61-c75e-4920-9700-0d25c070a05e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "014b0f8c-bdce-4253-8f41-ffcbc91801c7",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "dbbfadf6-e620-470a-9c80-7555fe5e80f4",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [],
                        "z": 81
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "13651bb7-4d8c-4098-8397-c26c679935d1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "90dd9150-5f28-4f6b-80fb-04a2a7ef641e",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "014b0f8c-bdce-4253-8f41-ffcbc91801c7",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 85
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "fe76de1d-d018-4bb2-9299-207178d1ea70",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "dbbfadf6-e620-470a-9c80-7555fe5e80f4",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "72c21228-914b-4963-94af-3d781c321f39",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 86
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bb4d928b-e4c4-4a85-9a3b-fc839e78d09e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "21ef810d-17ff-4190-a30b-49982453db83",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "84d8cf57-de36-483e-bb67-6631cfc4eef9",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 147
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "10b05e59-83bd-480b-9779-91e7e82723a2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "84d8cf57-de36-483e-bb67-6631cfc4eef9",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7aca6b7c-11e5-491c-a302-0ae45b6fcc5e",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 148
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d37cf814-f2ca-4354-a13c-260d30bc5d10",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7aca6b7c-11e5-491c-a302-0ae45b6fcc5e",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "24c47fc4-f8f4-485e-bc1f-15be589d7bc4",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 151
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "42849d3d-4a2f-4a23-abb1-0406f7351bd6",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b448989e-fa85-417f-8798-0b17cadac757",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "8891b45a-715a-40e7-863f-8dc1be3ef024",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 364
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5067a151-caea-43a5-b785-9fe2873c3086",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b448989e-fa85-417f-8798-0b17cadac757",
                            "port": "out-2",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "93fa5b71-e7df-4e5a-a5ee-9d97082b2c39",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 365
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0828b953-c412-472d-9669-0898f70da3be",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "8891b45a-715a-40e7-863f-8dc1be3ef024",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "47ff0215-a04d-4da5-b786-3012ad5db0af",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 367
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all detals of actions \n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Post End Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "24c47fc4-f8f4-485e-bc1f-15be589d7bc4",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 951,
                        "line_start": 938,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 29,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2420,
                            "y": -100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 373
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "c1224853-b2a3-466a-98e3-3757beba811e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "dae33605-8d09-4498-b004-989cd7dc6d58",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 376
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7112358d-32de-4657-9767-0183f2016198",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "47ff0215-a04d-4da5-b786-3012ad5db0af",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "33d17ccf-4e90-4f8e-8c4f-21a2e1e8a2e6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 378
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "8ee8b556-b85d-4230-9bf3-b2abac1ec96e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "33d17ccf-4e90-4f8e-8c4f-21a2e1e8a2e6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 389
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "29be99d0-c6a4-4d56-9b12-9907611f124d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "47ff0215-a04d-4da5-b786-3012ad5db0af",
                            "port": "out-2",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 390
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6661c7ee-f5f3-4fbf-9745-d04f55983bff",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "93fa5b71-e7df-4e5a-a5ee-9d97082b2c39",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "8c48f519-7890-43ba-9219-41e5af73d928",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 393
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f4341e4e-b4da-4384-970f-9d23ebd9025e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "8c48f519-7890-43ba-9219-41e5af73d928",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "64e45053-ff44-4868-8640-f9bced521891",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 395
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f04fe463-3b2a-49a6-b868-44cfc22e17bd",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "64e45053-ff44-4868-8640-f9bced521891",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 399
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "88cbf364-a40d-4fdc-ae6b-e969b92829c2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "8c48f519-7890-43ba-9219-41e5af73d928",
                            "port": "out-2",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 405
                    },
                    {
                        "action": "post data",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "data": "Post_Start_Event_to_Splunk:action_result.parameter.data",
                            "host": "Post_Start_Event_to_Splunk:action_result.parameter.host",
                            "index": "Post_Start_Event_to_Splunk:action_result.parameter.index",
                            "source": "Post_Start_Event_to_Splunk:action_result.parameter.source",
                            "source_type": "Post_Start_Event_to_Splunk:action_result.parameter.source_type"
                        },
                        "angle": 0,
                        "app": "Splunk",
                        "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                        "approver": "",
                        "assets": [
                            {
                                "action": "post data",
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.23",
                                "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                                "config_type": "app",
                                "fields": {
                                    "data": "Post_Start_Event_to_Splunk:action_result.parameter.data",
                                    "host": "Post_Start_Event_to_Splunk:action_result.parameter.host",
                                    "index": "Post_Start_Event_to_Splunk:action_result.parameter.index",
                                    "source": "Post_Start_Event_to_Splunk:action_result.parameter.source",
                                    "source_type": "Post_Start_Event_to_Splunk:action_result.parameter.source_type"
                                },
                                "has_app": true,
                                "id": 119,
                                "loaded": false,
                                "missing": false,
                                "name": "Splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.host",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "data": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Data to post",
                                        "key": "data",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "host": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Host for event",
                                        "key": "host",
                                        "order": 1,
                                        "required": false
                                    },
                                    "index": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Index to send event to",
                                        "key": "index",
                                        "order": 4,
                                        "required": false
                                    },
                                    "source": {
                                        "data_type": "string",
                                        "default": "Phantom",
                                        "description": "Source for event",
                                        "key": "source",
                                        "order": 2,
                                        "required": false
                                    },
                                    "source_type": {
                                        "data_type": "string",
                                        "default": "Automation/Orchestration Platform",
                                        "description": "Type of source for event",
                                        "key": "source_type",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Post Error Msg 2"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Post_Error_Msg_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Post_Error_Msg_2() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Post_Error_Msg_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:action_result.parameter.data', 'Post_Start_Event_to_Splunk:action_result.parameter.host', 'Post_Start_Event_to_Splunk:action_result.parameter.source', 'Post_Start_Event_to_Splunk:action_result.parameter.source_type', 'Post_Start_Event_to_Splunk:action_result.parameter.index', 'Post_Start_Event_to_Splunk:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Post_Error_Msg_2' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'data': results_item_1[0],\n                'host': results_item_1[1],\n                'source': results_item_1[2],\n                'source_type': results_item_1[3],\n                'index': results_item_1[4],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[5]},\n            })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=join_Format_End_Marker, name=\"Post_Error_Msg_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Cmd Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Post_Error_Msg_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Post_Error_Msg_2() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Post_Error_Msg_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:action_result.parameter.data', 'Post_Start_Event_to_Splunk:action_result.parameter.host', 'Post_Start_Event_to_Splunk:action_result.parameter.source', 'Post_Start_Event_to_Splunk:action_result.parameter.source_type', 'Post_Start_Event_to_Splunk:action_result.parameter.index', 'Post_Start_Event_to_Splunk:action_result.parameter.context.artifact_id'], action_results=results)\n\n    filtered_results_data_1 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_3:condition_1:Run_Cmd_Test:action_result.data.*.std_err\", \"filtered-data:filter_3:condition_1:Run_Cmd_Test:action_result.parameter.context.artifact_id\"])\n    \n    id_value = container.get('id', None)\n    \n    parameters = []\n    \n    # build parameters list for 'Post_Error_Msg_2' call\n    for results_item_1 in results_data_1:\n        for filtered_item_1 in filtered_results_data_1:\n            \n            if filtered_item_1[0]:\n                phantom.debug(results_item_1[0])\n                results_item_1[0] = json.loads(results_item_1[0])\n                results_item_1[0] = json.dumps({\"guid\": results_item_1[0][\"guid\"], \"msg\": \"Likely error in cmd.exe command run on endpoint. See Phantom event {0} for more details.\".format(id_value),\n                                            \"std_err\": filtered_item_1[0]})\n                parameters.append({\n                    'data': results_item_1[0],\n                    'host': results_item_1[1],\n                    'source': results_item_1[2],\n                    'source_type': results_item_1[3],\n                    'index': results_item_1[4],\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[5]},\n                })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=join_Format_End_Marker, name=\"Post_Error_Msg_2\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "Post Error Msg 2",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "64e45053-ff44-4868-8640-f9bced521891",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 700,
                        "line_start": 663,
                        "message": "Configuring now",
                        "name": "post data",
                        "notes": "",
                        "number": 4,
                        "order": 19,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1740,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "Post_Error_Msg_2",
                        "required_params": {
                            "data": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 497
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'Format_Start_Event' block\n    Format_Start_Event(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "90dd9150-5f28-4f6b-80fb-04a2a7ef641e",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 25,
                        "line_start": 17,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 120,
                            "y": -120
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 506
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2f4e2fd9-177b-4e33-9955-5eebd2cb9585",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "e29675fd-9f55-44ff-9301-8429275e8bcf",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b448989e-fa85-417f-8798-0b17cadac757",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 509
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7c2c4fce-3c69-4f72-94f0-e57509137596",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "39f1ac18-2560-4ccb-b6c2-e19d8cae9e11",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 540
                    },
                    {
                        "action": "run script",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "async": "",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                            "parser": "",
                            "script_file": "",
                            "script_str": "artifact:*.cef.manual_powershell",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run script",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.19",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "async": "",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                                    "parser": "",
                                    "script_file": "",
                                    "script_str": "artifact:*.cef.manual_powershell",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 36,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_str",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_file": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a PowerShell script to run",
                                        "key": "script_file",
                                        "order": 1,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_str": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "A PowerShell script to run",
                                        "key": "script_str",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run Manual Powershell"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_Manual_Powershell(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_Manual_Powershell() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_Manual_Powershell' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.manual_powershell', 'artifact:*.id'])\n    results_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:action_result.parameter.ip_hostname', 'Run_Start_Marker:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Run_Manual_Powershell' call\n    for container_item in container_data:\n        for results_item_1 in results_data_1:\n            if results_item_1[0]:\n                parameters.append({\n                    'shell_id': \"\",\n                    'parser': \"\",\n                    'ip_hostname': results_item_1[0],\n                    'async': \"\",\n                    'script_str': container_item[0],\n                    'script_file': \"\",\n                    'command_id': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(\"run script\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=join_Format_End_Marker, name=\"Run_Manual_Powershell\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run Manual Powershell",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "39f1ac18-2560-4ccb-b6c2-e19d8cae9e11",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 765,
                        "line_start": 734,
                        "message": "Configuring now",
                        "name": "run script",
                        "notes": "",
                        "number": 4,
                        "order": 21,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 300
                        },
                        "previous_function": "",
                        "previous_name": "Run_Manual_Powershell",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 541
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-2": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": -2
                            },
                            ".outPorts>.port-2>.port-body": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('decision_2() called')\n\n    # check for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.os\", \"==\", \"windows\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched_artifacts_1 or matched_results_1:\n        Format_Start_Marker(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    # check for 'elif' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.os\", \"==\", \"linux\"],\n        ])\n\n    # call connected blocks if condition 2 matched\n    if matched_artifacts_2 or matched_results_2:\n        Format_ART_Linux_Test(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    # check for 'elif' condition 3\n    matched_artifacts_3, matched_results_3 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.os\", \"==\", \"macos\"],\n        ])\n\n    # call connected blocks if condition 3 matched\n    if matched_artifacts_3 or matched_results_3:\n        Format_ART_MacOS_Test(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Post Start Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": false,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "72c21228-914b-4963-94af-3d781c321f39",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 187,
                        "line_start": 143,
                        "name": "decision",
                        "notes": "",
                        "number": 2,
                        "order": 6,
                        "outPorts": [
                            "out-1",
                            "out-2",
                            "out-3"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.os",
                                        "value": "windows"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.os",
                                        "value": "linux"
                                    }
                                ],
                                "display": "Else If",
                                "logic": "and",
                                "type": "elif"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.os",
                                        "value": "macos"
                                    }
                                ],
                                "display": "Else If",
                                "logic": "and",
                                "type": "elif"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 380,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "decision_2",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 552
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5a272ac7-58a0-4359-9050-f810158792ed",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "09a940ba-2076-43da-9fb6-47fca922f0ab",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "39f1ac18-2560-4ccb-b6c2-e19d8cae9e11",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 572
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f320310a-63d0-4541-b556-c52366488801",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "09a940ba-2076-43da-9fb6-47fca922f0ab",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "dae33605-8d09-4498-b004-989cd7dc6d58",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 573
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "721e8f04-de6b-4e31-8cb9-dcad52e9d14a",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "09a940ba-2076-43da-9fb6-47fca922f0ab",
                            "port": "out-3",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(3) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "e29675fd-9f55-44ff-9301-8429275e8bcf",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 576
                    },
                    {
                        "action": "run command",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "arguments": "",
                            "async": "",
                            "command": "artifact:*.cef.manual_command",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                            "parser": "",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run command",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.19",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "arguments": "",
                                    "async": "",
                                    "command": "artifact:*.cef.manual_command",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                                    "parser": "",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 36,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.arguments",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "arguments": {
                                        "data_type": "string",
                                        "default": "",
                                        "description": "The arguments for the command",
                                        "key": "arguments",
                                        "order": 2,
                                        "required": false
                                    },
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The command to be run",
                                        "key": "command",
                                        "order": 1,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run Manual Cmd"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_Manual_Cmd(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_Manual_Cmd() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_Manual_Cmd' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.manual_command', 'artifact:*.id'])\n    results_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:action_result.parameter.ip_hostname', 'Run_Start_Marker:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Run_Manual_Cmd' call\n    for container_item in container_data:\n        for results_item_1 in results_data_1:\n            if results_item_1[0]:\n                parameters.append({\n                    'shell_id': \"\",\n                    'parser': \"\",\n                    'ip_hostname': results_item_1[0],\n                    'command': container_item[0],\n                    'arguments': \"\",\n                    'async': \"\",\n                    'command_id': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(\"run command\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=join_Format_End_Marker, name=\"Run_Manual_Cmd\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run Manual Cmd",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "dae33605-8d09-4498-b004-989cd7dc6d58",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 244,
                        "line_end": 235,
                        "line_start": 204,
                        "message": "Configuring now",
                        "name": "run command",
                        "notes": "",
                        "number": 2,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "Run_Manual_Cmd",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 577
                    },
                    {
                        "action": "run command",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "arguments": "Format_ART_Command:action_result.data.*.executor.command",
                            "async": "True",
                            "command": "Format_ART_Command:action_result.data.*.executor.command",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                            "parser": "",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run command",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.19",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "arguments": "Format_ART_Command:action_result.data.*.executor.command",
                                    "async": "True",
                                    "command": "Format_ART_Command:action_result.data.*.executor.command",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                                    "parser": "",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 36,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.arguments",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "arguments": {
                                        "data_type": "string",
                                        "default": "",
                                        "description": "The arguments for the command",
                                        "key": "arguments",
                                        "order": 2,
                                        "required": false
                                    },
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The command to be run",
                                        "key": "command",
                                        "order": 1,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run Cmd Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def cmd_test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('cmd_test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'cmd_test' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationAddress', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'cmd_test' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip_hostname': container_item[0],\n                'command': \"\",\n                'arguments': \"\",\n                'parser': \"\",\n                'async': \"\",\n                'command_id': \"\",\n                'shell_id': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"run command\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=join_format_2, name=\"cmd_test\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 326,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Format ART Command",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Run_Cmd_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_Cmd_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_Cmd_Test' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:action_result.parameter.ip_hostname', 'Run_Start_Marker:action_result.parameter.context.artifact_id'], action_results=results)\n    results_data_2 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_1:condition_2:Format_ART_Command:action_result.data.*.executor.command\", \"filtered-data:filter_1:condition_2:Format_ART_Command:action_result.parameter.context.artifact_id\"])\n\n    parameters = []\n    \n    # build parameters list for 'Run_Cmd_Test' call\n    for results_item_1 in results_data_1:\n        for results_item_2 in results_data_2:\n            phantom.debug(results_item_2[0])\n            if '\\n' in results_item_2[0]:\n                cmd_list = results_item_2[0].split('\\n')\n                for each_cmd in cmd_list:\n                    if each_cmd.strip() == \"\":\n                        continue\n                    elif ' ' in each_cmd:\n                        parameters.append({\n                            'ip_hostname': results_item_1[0],\n                            'command': each_cmd.split(' ', 1)[0],\n                            'arguments': each_cmd.split(' ', 1)[1],\n                            'parser': \"\",\n                            'async': False,\n                            'command_id': \"\",\n                            'shell_id': \"\",\n                            # context (artifact id) is added to associate results with the artifact\n                            'context': {'artifact_id': results_item_1[1]},\n                        })\n                    else:\n                        parameters.append({\n                            'ip_hostname': results_item_1[0],\n                            'command': each_cmd,\n                            'arguments': \"\",\n                            'parser': \"\",\n                            'async': False,\n                            'command_id': \"\",\n                            'shell_id': \"\",\n                            # context (artifact id) is added to associate results with the artifact\n                            'context': {'artifact_id': results_item_1[1]},\n                        })\n            else:\n                parameters.append({\n                    'ip_hostname': results_item_1[0],\n                    'command': results_item_2[0].split(' ', 1)[0],\n                    'arguments': results_item_2[0].split(' ', 1)[1],\n                    'parser': \"\",\n                    'async': False,\n                    'command_id': \"\",\n                    'shell_id': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n    phantom.debug(parameters)\n\n    phantom.act(\"run command\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=filter_3, name=\"Run_Cmd_Test\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "Run Cmd Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "93fa5b71-e7df-4e5a-a5ee-9d97082b2c39",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 426,
                        "line_start": 364,
                        "message": "Configuring now",
                        "name": "run command",
                        "notes": "",
                        "number": 1,
                        "order": 13,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1360,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "Run_Cmd_Test",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 578
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def filter_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_3() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Cmd_Test:action_result.data.*.status_code\", \"!=\", 0],\n        ],\n        name=\"filter_3:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Post_Error_Msg_2(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Cmd_Test:action_result.data.*.status_code\", \"==\", 0],\n        ],\n        name=\"filter_3:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        join_Format_End_Marker(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Cmd Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def filter_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_3() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Cmd_Test:action_result.data.*.status_code\", \"!=\", 0],\n        ],\n        name=\"filter_3:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        phantom.save_run_data(value='present', key='cmd_error', auto=True)\n        Post_Error_Msg_2(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Cmd_Test:action_result.data.*.status_code\", \"==\", 0],\n        ],\n        name=\"filter_3:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        join_Format_End_Marker(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "8c48f519-7890-43ba-9219-41e5af73d928",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 663,
                        "line_start": 631,
                        "name": "filter",
                        "notes": "",
                        "number": 3,
                        "order": 18,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "Run_Cmd_Test:action_result.data.*.status_code",
                                        "value": "0"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Run_Cmd_Test:action_result.data.*.status_code",
                                        "value": "0"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1600,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "filter_3",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 582
                    },
                    {
                        "action": "run script",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "async": "",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                            "parser": "",
                            "script_file": "",
                            "script_str": "filtered-data:filter_1:condition_1:Format_ART_Command:action_result.data.*.executor.command",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run script",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.19",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "async": "",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                                    "parser": "",
                                    "script_file": "",
                                    "script_str": "filtered-data:filter_1:condition_1:Format_ART_Command:action_result.data.*.executor.command",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 36,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_str",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_file": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a PowerShell script to run",
                                        "key": "script_file",
                                        "order": 1,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_str": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "A PowerShell script to run",
                                        "key": "script_str",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run Powershell Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_Powershell_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_Powershell_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_Powershell_Test' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:action_result.parameter.ip_hostname', 'Run_Start_Marker:action_result.parameter.context.artifact_id'], action_results=results)\n    filtered_results_data_1 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_1:condition_1:Format_ART_Command:action_result.data.*.executor.command\", \"filtered-data:filter_1:condition_1:Format_ART_Command:action_result.parameter.context.artifact_id\"])\n\n    parameters = []\n    \n    # build parameters list for 'Run_Powershell_Test' call\n    for results_item_1 in results_data_1:\n        for filtered_results_item_1 in filtered_results_data_1:\n            if results_item_1[0]:\n                parameters.append({\n                    'shell_id': \"\",\n                    'parser': \"\",\n                    'ip_hostname': results_item_1[0],\n                    'async': \"\",\n                    'script_str': filtered_results_item_1[0],\n                    'script_file': \"\",\n                    'command_id': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(\"run script\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=filter_2, name=\"Run_Powershell_Test\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Format ART Command",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run Powershell Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "8891b45a-715a-40e7-863f-8dc1be3ef024",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 364,
                        "line_start": 333,
                        "message": "Configuring now",
                        "name": "run script",
                        "notes": "",
                        "number": 1,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1360,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "Run_Powershell_Test",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 585
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "Format Start Event"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Format_Start_Event(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_Start_Event() called')\n    \n    template = \"\"\"Started red team test: {0}  on machine with IP address: {1}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.act\",\n        \"artifact:*.cef.destinationAddress\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"Format_Start_Event\")\n\n    Post_Start_Event_to_Splunk(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Format Start Event",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "014b0f8c-bdce-4253-8f41-ffcbc91801c7",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 204,
                        "line_start": 187,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 3,
                        "order": 7,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.act"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "artifact:*.cef.destinationAddress"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 160,
                            "y": -20
                        },
                        "previous_function": "",
                        "previous_name": "Format_Start_Event",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Started red team test: {0}  on machine with IP address: {1}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 653
                    },
                    {
                        "action": "post data",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "data": "format_4:formatted_data",
                            "host": "post_data_1:action_result.parameter.host",
                            "index": "",
                            "source": "post_data_1:action_result.parameter.source",
                            "source_type": "post_data_1:action_result.parameter.source_type"
                        },
                        "angle": 0,
                        "app": "Splunk",
                        "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                        "approver": "",
                        "assets": [
                            {
                                "action": "post data",
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.19",
                                "appid": "",
                                "config_type": "app",
                                "fields": {
                                    "data": "Format_End_Event:formatted_data",
                                    "host": "Post_Start_Event_to_Splunk:action_result.parameter.host",
                                    "index": "",
                                    "source": "Post_Start_Event_to_Splunk:action_result.parameter.source",
                                    "source_type": "Post_Start_Event_to_Splunk:action_result.parameter.source_type"
                                },
                                "has_app": true,
                                "id": 7,
                                "loaded": false,
                                "missing": false,
                                "name": "Splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.host",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "data": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Data to post",
                                        "key": "data",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "host": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Host for event",
                                        "key": "host",
                                        "order": 1,
                                        "required": false
                                    },
                                    "index": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Index to send event to",
                                        "key": "index",
                                        "order": 4,
                                        "required": false
                                    },
                                    "source": {
                                        "data_type": "string",
                                        "default": "Phantom",
                                        "description": "Source for event",
                                        "key": "source",
                                        "order": 2,
                                        "required": false
                                    },
                                    "source_type": {
                                        "data_type": "string",
                                        "default": "Automation/Orchestration Platform",
                                        "description": "Type of source for event",
                                        "key": "source_type",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Post End Event to Splunk"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def post_data_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('post_data_2() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'post_data_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['post_data_1:action_result.parameter.host', 'post_data_1:action_result.parameter.source_type', 'post_data_1:action_result.parameter.source', 'post_data_1:action_result.parameter.context.artifact_id'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='format_4')\n\n    parameters = []\n    \n    # build parameters list for 'post_data_2' call\n    for results_item_1 in results_data_1:\n        parameters.append({\n            'index': \"\",\n            'host': results_item_1[0],\n            'source_type': results_item_1[1],\n            'data': formatted_data_1,\n            'source': results_item_1[2],\n            # context (artifact id) is added to associate results with the artifact\n            'context': {'artifact_id': results_item_1[3]},\n        })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, name=\"post_data_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run End Marker, Run ART MacOS Test, Run ART Linux Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Post_End_Event_to_Splunk(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('post_data_2() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'post_data_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:action_result.parameter.host', 'Post_Start_Event_to_Splunk:action_result.parameter.source_type', 'Post_Start_Event_to_Splunk:action_result.parameter.source', 'Post_Start_Event_to_Splunk:action_result.parameter.context.artifact_id', 'Post_Start_Event_to_Splunk:action_result.parameter.data', 'Post_Start_Event_to_Splunk:action_result.parameter.index'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='Format_End_Event')\n\n    parameters = []\n    \n    # build parameters list for 'post_data_2' call\n    for results_item_1 in results_data_1:\n        data_json = results_item_1[4]\n        data = json.loads(data_json)\n        data['msg'] = formatted_data_1\n        data_json = json.dumps(data)\n        parameters.append({\n            'index': results_item_1[5],\n            'host': results_item_1[0],\n            'source_type': results_item_1[1],\n            'data': data_json,\n            'source': results_item_1[2],\n            # context (artifact id) is added to associate results with the artifact\n            'context': {'artifact_id': results_item_1[3]},\n        })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, name=\"Post_End_Event_to_Splunk\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "Post End Event to Splunk",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7aca6b7c-11e5-491c-a302-0ae45b6fcc5e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 82,
                        "line_start": 51,
                        "message": "Configuring now",
                        "name": "post data",
                        "notes": "",
                        "number": 2,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2300,
                            "y": 0
                        },
                        "previous_function": "",
                        "previous_name": "Post_End_Event_to_Splunk",
                        "required_params": {
                            "data": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 658
                    },
                    {
                        "action": "post data",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "data": "format_3:formatted_data",
                            "host": "aws_phantom",
                            "index": "",
                            "source": "Phantom",
                            "source_type": "Automation/Orchestration Platform"
                        },
                        "angle": 0,
                        "app": "Splunk",
                        "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                        "approver": "",
                        "assets": [
                            {
                                "action": "post data",
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.19",
                                "appid": "",
                                "config_type": "app",
                                "fields": {
                                    "data": "Format_Start_Event:formatted_data",
                                    "host": "aws_phantom",
                                    "index": "",
                                    "source": "Phantom",
                                    "source_type": "Automation/Orchestration Platform"
                                },
                                "has_app": true,
                                "id": 7,
                                "loaded": false,
                                "missing": false,
                                "name": "Splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.host",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "data": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Data to post",
                                        "key": "data",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "host": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Host for event",
                                        "key": "host",
                                        "order": 1,
                                        "required": false
                                    },
                                    "index": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Index to send event to",
                                        "key": "index",
                                        "order": 4,
                                        "required": false
                                    },
                                    "source": {
                                        "data_type": "string",
                                        "default": "Phantom",
                                        "description": "Source for event",
                                        "key": "source",
                                        "order": 2,
                                        "required": false
                                    },
                                    "source_type": {
                                        "data_type": "string",
                                        "default": "Automation/Orchestration Platform",
                                        "description": "Type of source for event",
                                        "key": "source_type",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Post Start Event to Splun..."
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_error.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def post_data_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('post_data_1() called')\n\n    # collect data for 'post_data_1' call\n    formatted_data_1 = phantom.get_format_data(name='format_3')\n\n    parameters = []\n    \n    # build parameters list for 'post_data_1' call\n    parameters.append({\n        'index': \"\",\n        'host': \"aws_phantom\",\n        'source_type': \"Automation/Orchestration Platform\",\n        'data': formatted_data_1,\n        'source': \"Phantom\",\n    })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=decision_2, name=\"post_data_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "def Post_Start_Event_to_Splunk(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('post_data_1() called')\n\n    # collect data for 'post_data_1' call\n    formatted_data_1 = phantom.get_format_data(name='Format_Start_Event')\n\n    parameters = []\n    \n    splunk_status_index_list = phantom.collect(container, \"artifact:*.cef.splunk_status_index\")\n    if len(splunk_status_index_list) > 0:\n        splunk_status_index = str(splunk_status_index_list[0])\n    else:\n        splunk_status_index = \"default\"\n    \n    splunk_status_source_type_list = phantom.collect(container, \"artifact:*.cef.splunk_status_source_type\")\n    if len(splunk_status_source_type_list) > 0:\n        splunk_status_source_type = str(splunk_status_source_type_list[0])\n    else:\n        splunk_status_source_type = \"advsim:atr\"\n    \n    try:\n        guid = phantom.collect(container, \"artifact:*.cef.request\")[0]\n        phantom.debug(\"collected GUID from artifact\")\n    except:\n        guid = uuid.uuid4().hex    \n    phantom.debug(guid)\n    \n    playbook_info = phantom.get_playbook_info()\n    phantom.save_data(guid, playbook_info[0]['id'])\n    source = playbook_info[0]['name']\n    data = {}\n    data['msg'] = formatted_data_1\n    data['guid'] = guid\n    data['playbook_info'] = playbook_info[0]\n    data_json = json.dumps(data)\n\n    # build parameters list for 'post_data_1' call\n    parameters.append({\n        'index': splunk_status_index,\n        'host': platform.node(),\n        'source_type': splunk_status_source_type,\n        'data': data_json,\n        'source': source,\n    })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=decision_2, name=\"Post_Start_Event_to_Splunk\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "Post Start Event to Splunk",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "dbbfadf6-e620-470a-9c80-7555fe5e80f4",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 303,
                        "line_start": 254,
                        "message": "Configuring now",
                        "name": "post data",
                        "notes": "",
                        "number": 1,
                        "order": 10,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 180,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "Post_Start_Event_to_Splunk",
                        "required_params": {
                            "data": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 659
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "8d4a290f-00a1-4099-9903-df1e6b51f9d3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "73edf05d-71cf-4a86-b83e-4b7b89b8e1a0",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "cd5573a4-4cff-40d6-af38-f9508e4dc7cc",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 664
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b25780bf-4636-4c61-94ba-c7dbed2652ae",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "72c21228-914b-4963-94af-3d781c321f39",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "271a5122-bfea-4368-8c37-677ff25f5e50",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 679
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0a64cf6e-4d21-478d-b622-2c7361aae850",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "271a5122-bfea-4368-8c37-677ff25f5e50",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "e940c571-b417-40c2-adff-1359fd944c38",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 683
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "ca9d2e6c-b1f5-4c68-a2f1-93aaf8da05e2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "72c21228-914b-4963-94af-3d781c321f39",
                            "port": "out-3",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(3) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "cdf1228b-0dc1-4492-89d6-1d2c553b2365",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 695
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "858b317a-3acc-425f-9729-182925580da8",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cdf1228b-0dc1-4492-89d6-1d2c553b2365",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1afa9143-6c8f-44bd-8867-cd66eb541da4",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 700
                    },
                    {
                        "action": "execute program",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "command": "Format_ART_MacOS_Test:action_result.data.*.executor.command",
                            "ip_hostname": "Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress",
                            "script_file": "",
                            "timeout": ""
                        },
                        "angle": 0,
                        "app": "SSH",
                        "appid": "d37aa7fe-c973-44ee-a164-2ca5bf321b1f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "execute program",
                                "actions": [
                                    "put file",
                                    "get file",
                                    "get memory usage",
                                    "get disk usage",
                                    "list processes",
                                    "logoff user",
                                    "terminate process",
                                    "shutdown system",
                                    "reboot system",
                                    "delete firewall rule",
                                    "list firewall rules",
                                    "block ip",
                                    "list connections",
                                    "execute program",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "SSH",
                                "app_version": "1.0.47",
                                "appid": "d37aa7fe-c973-44ee-a164-2ca5bf321b1f",
                                "asset_name": "dect_lab_logger",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "command": "Format_ART_MacOS_Test:action_result.data.*.executor.command",
                                    "ip_hostname": "Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress",
                                    "script_file": "",
                                    "timeout": ""
                                },
                                "has_app": true,
                                "id": 9,
                                "loaded": false,
                                "missing": false,
                                "name": "dect_lab_logger",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.timeout",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.output",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.exit_status",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "command": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command to be executed on endpoint",
                                        "key": "command",
                                        "order": 1,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Hostname/IP to execute command on",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "script_file": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Local path to shell script",
                                        "key": "script_file",
                                        "order": 2,
                                        "required": false
                                    },
                                    "timeout": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Seconds before timeout (Default: 60)",
                                        "key": "timeout",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "SSH",
                                "product_vendor": "Generic",
                                "targets": "9",
                                "type": "endpoint"
                            },
                            {
                                "action": "execute program",
                                "active": true,
                                "app_name": "SSH",
                                "app_version": "1.0.47",
                                "appid": "d37aa7fe-c973-44ee-a164-2ca5bf321b1f",
                                "config_type": "app",
                                "fields": {
                                    "command": "Format_ART_MacOS_Test:action_result.data.*.executor.command",
                                    "ip_hostname": "Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress",
                                    "script_file": "",
                                    "timeout": ""
                                },
                                "has_app": true,
                                "id": 37,
                                "loaded": false,
                                "missing": false,
                                "name": "SSH",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.timeout",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.output",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.exit_status",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "command": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command to be executed on endpoint",
                                        "key": "command",
                                        "order": 1,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Hostname/IP to execute command on",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "script_file": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Local path to shell script",
                                        "key": "script_file",
                                        "order": 2,
                                        "required": false
                                    },
                                    "timeout": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Seconds before timeout (Default: 60)",
                                        "key": "timeout",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "SSH",
                                "product_vendor": "Generic",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run ART MacOS Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_ART_MacOS_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_ART_MacOS_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_ART_MacOS_Test' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Format_ART_MacOS_Test:action_result.data.*.executor.command', 'Format_ART_MacOS_Test:action_result.parameter.context.artifact_id'], action_results=results)\n    inputs_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress', 'Post_Start_Event_to_Splunk:artifact:*.id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Run_ART_MacOS_Test' call\n    for results_item_1 in results_data_1:\n        for inputs_item_1 in inputs_data_1:\n            if inputs_item_1[0]:\n                parameters.append({\n                    'command': results_item_1[0],\n                    'timeout': \"\",\n                    'ip_hostname': inputs_item_1[0],\n                    'script_file': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(\"execute program\", parameters=parameters, app={ \"name\": 'SSH' }, assets=['dect_lab_logger'], callback=join_Format_End_Event, name=\"Run_ART_MacOS_Test\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Format ART MacOS Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run ART MacOS Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "1afa9143-6c8f-44bd-8867-cd66eb541da4",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 917,
                        "line_start": 889,
                        "message": "Configuring now",
                        "name": "execute program",
                        "notes": "Requires SSH to be enabled on Mac Endpoint",
                        "number": 2,
                        "order": 27,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2000,
                            "y": -200
                        },
                        "previous_function": "",
                        "previous_name": "Run_ART_MacOS_Test",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_app_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 707
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2d86e6d8-379f-4aa1-b896-e3ca14348175",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cd5573a4-4cff-40d6-af38-f9508e4dc7cc",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 710
                    },
                    {
                        "action": "post data",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "data": "Post_Start_Event_to_Splunk:action_result.parameter.data",
                            "host": "Post_Start_Event_to_Splunk:action_result.parameter.host",
                            "index": "Post_Start_Event_to_Splunk:action_result.parameter.index",
                            "source": "Post_Start_Event_to_Splunk:action_result.parameter.source",
                            "source_type": "Post_Start_Event_to_Splunk:action_result.parameter.source_type"
                        },
                        "angle": 0,
                        "app": "Splunk",
                        "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                        "approver": "",
                        "assets": [
                            {
                                "action": "post data",
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.23",
                                "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                                "config_type": "app",
                                "fields": {
                                    "data": "Post_Start_Event_to_Splunk:action_result.parameter.data",
                                    "host": "Post_Start_Event_to_Splunk:action_result.parameter.host",
                                    "index": "Post_Start_Event_to_Splunk:action_result.parameter.index",
                                    "source": "Post_Start_Event_to_Splunk:action_result.parameter.source",
                                    "source_type": "Post_Start_Event_to_Splunk:action_result.parameter.source_type"
                                },
                                "has_app": true,
                                "id": 119,
                                "loaded": false,
                                "missing": false,
                                "name": "Splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.host",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.source_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "data": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Data to post",
                                        "key": "data",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "host": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Host for event",
                                        "key": "host",
                                        "order": 1,
                                        "required": false
                                    },
                                    "index": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Index to send event to",
                                        "key": "index",
                                        "order": 4,
                                        "required": false
                                    },
                                    "source": {
                                        "data_type": "string",
                                        "default": "Phantom",
                                        "description": "Source for event",
                                        "key": "source",
                                        "order": 2,
                                        "required": false
                                    },
                                    "source_type": {
                                        "data_type": "string",
                                        "default": "Automation/Orchestration Platform",
                                        "description": "Type of source for event",
                                        "key": "source_type",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Post Error Msg"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Post_Error_Msg(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Post_Error_Msg() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Post_Error_Msg' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:action_result.parameter.data', 'Post_Start_Event_to_Splunk:action_result.parameter.host', 'Post_Start_Event_to_Splunk:action_result.parameter.source', 'Post_Start_Event_to_Splunk:action_result.parameter.source_type', 'Post_Start_Event_to_Splunk:action_result.parameter.index', 'Post_Start_Event_to_Splunk:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Post_Error_Msg' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'data': results_item_1[0],\n                'host': results_item_1[1],\n                'source': results_item_1[2],\n                'source_type': results_item_1[3],\n                'index': results_item_1[4],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[5]},\n            })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=join_Format_End_Marker, name=\"Post_Error_Msg\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Powershell Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Post_Error_Msg(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Post_Error_Msg() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Post_Error_Msg' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:action_result.parameter.data', 'Post_Start_Event_to_Splunk:action_result.parameter.host', 'Post_Start_Event_to_Splunk:action_result.parameter.source', 'Post_Start_Event_to_Splunk:action_result.parameter.source_type', 'Post_Start_Event_to_Splunk:action_result.parameter.index', 'Post_Start_Event_to_Splunk:action_result.parameter.context.artifact_id'], action_results=results)\n    \n    filtered_results_data_1 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_2:condition_1:Run_Powershell_Test:action_result.data.*.std_err\", \"filtered-data:filter_2:condition_1:Run_Powershell_Test:action_result.parameter.context.artifact_id\"])\n    \n    id_value = container.get('id', None)\n\n    parameters = []\n    \n    # build parameters list for 'Post_Error_Msg' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            phantom.debug(results_item_1[0])\n            results_item_1[0] = json.loads(results_item_1[0])\n            results_item_1[0] = json.dumps({\"guid\": results_item_1[0][\"guid\"], \n                                            \"msg\": \"Likely error in powershell script run on endpoint. See Phantom event {0} for more details.\".format(id_value),\n                                          \"std_err\": filtered_results_data_1[0][0]})\n            parameters.append({\n                'data': results_item_1[0],\n                'host': results_item_1[1],\n                'source': results_item_1[2],\n                'source_type': results_item_1[3],\n                'index': results_item_1[4],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[5]},\n            })\n\n    phantom.act(\"post data\", parameters=parameters, app={ \"name\": 'Splunk' }, callback=join_Format_End_Marker, name=\"Post_Error_Msg\")\n\n    return",
                        "custom_join": "",
                        "custom_name": "Post Error Msg",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "33d17ccf-4e90-4f8e-8c4f-21a2e1e8a2e6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 631,
                        "line_start": 595,
                        "message": "Configuring now",
                        "name": "post data",
                        "notes": "",
                        "number": 3,
                        "order": 17,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1740,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "Post_Error_Msg",
                        "required_params": {
                            "data": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 711
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def filter_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_1() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Format_ART_Command:action_result.data.*.executor.name\", \"==\", \"powershell\"],\n        ],\n        name=\"filter_1:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Run_Powershell_Test(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Format_ART_Command:action_result.data.*.executor.name\", \"==\", \"command_prompt\"],\n        ],\n        name=\"filter_1:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        Run_Cmd_Test(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Format ART Command",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def filter_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_1() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Format_ART_Command:action_result.data.*.executor.name\", \"==\", \"powershell\"],\n        ],\n        name=\"filter_1:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        phantom.save_run_data(value='present', key='powershell_test', auto=True)\n        Run_Powershell_Test(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Format_ART_Command:action_result.data.*.executor.name\", \"==\", \"command_prompt\"],\n        ],\n        name=\"filter_1:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        phantom.save_run_data(value='present', key='cmd_test', auto=True)\n        Run_Cmd_Test(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b448989e-fa85-417f-8798-0b17cadac757",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 549,
                        "line_end": 563,
                        "line_start": 530,
                        "name": "filter",
                        "notes": "",
                        "number": 1,
                        "order": 15,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Format_ART_Command:action_result.data.*.executor.name",
                                        "value": "powershell"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Format_ART_Command:action_result.data.*.executor.name",
                                        "value": "command_prompt"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1220,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "filter_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 712
                    },
                    {
                        "action": "format command",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attack_id": "artifact:*.cef.act",
                            "input_arguments": "artifact:*.cef.input_arguments",
                            "supported_os": "artifact:*.cef.os",
                            "use_arg_defaults": true
                        },
                        "angle": 0,
                        "app": "Atomic Red Team",
                        "appid": "005e9bff-dfd2-40c8-9845-e32b438c2e93",
                        "approver": "",
                        "assets": [
                            {
                                "action": "format command",
                                "active": true,
                                "app_name": "Atomic Red Team",
                                "app_version": "1.0.0",
                                "appid": "",
                                "config_type": "app",
                                "fields": {
                                    "attack_id": "artifact:*.cef.act",
                                    "input_arguments": "artifact:*.cef.input_arguments",
                                    "supported_os": "artifact:*.cef.os"
                                },
                                "has_app": true,
                                "id": 155,
                                "loaded": false,
                                "missing": false,
                                "name": "Atomic Red Team",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "Formatted Command",
                                        "column_order": 3,
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.executor.command",
                                        "data_type": "string",
                                        "example_values": [
                                            "cmd.exe /c \"net use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator\"\n",
                                            "regsvr32.exe /s /u /i:Regsvr32.sct scrobj.dll\n"
                                        ]
                                    },
                                    {
                                        "column_name": "Shell Type",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.executor.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "command_prompt"
                                        ]
                                    },
                                    {
                                        "column_name": "Attack ID",
                                        "column_order": 0,
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.data.*.attack_technique",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total tests: 1",
                                            "Total tests: 3"
                                        ]
                                    },
                                    {
                                        "column_name": "Supported OS",
                                        "column_order": 1,
                                        "data_path": "action_result.parameter.supported_os",
                                        "data_type": "string",
                                        "example_values": [
                                            "windows"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.parameter.attack_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total tests",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.executor.arg_types",
                                        "data_type": "string",
                                        "example_values": [
                                            "Path"
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "attack_id": {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "MITRE ATT@CK ID for technique (e.g. T1033)",
                                        "key": "attack_id",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "input_arguments": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "JSON of input arguments",
                                        "key": "input_arguments",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "supported_os": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "OS to format command for",
                                        "key": "supported_os",
                                        "order": 1,
                                        "primary": false,
                                        "required": true,
                                        "value_list": [
                                            "windows",
                                            "macos",
                                            "linux"
                                        ]
                                    }
                                },
                                "product_name": "Atomic Red Team",
                                "product_vendor": "Red Canary",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Format ART Command"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_command_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_command_1() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'format_command_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.os', 'artifact:*.cef.act', 'artifact:*.cef.input_arguments', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'format_command_1' call\n    for container_item in container_data:\n        if container_item[0] and container_item[1]:\n            parameters.append({\n                'supported_os': container_item[0],\n                'attack_id': container_item[1],\n                'input_arguments': container_item[2],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[3]},\n            })\n\n    phantom.act(\"format command\", parameters=parameters, app={ \"name\": 'Atomic Red Team' }, callback=filter_1, name=\"format_command_1\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Format_ART_Command(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_command_1() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'format_command_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.os', 'artifact:*.cef.act', 'artifact:*.cef.input_arguments', 'artifact:*.id'])\n\n    parameters = []\n    # build parameters list for 'format_command_1' call\n    for container_item in container_data:\n        if container_item[0] and container_item[1]:\n            phantom.debug(container_item[1])\n\n            parameters.append({\n                'supported_os': container_item[0],\n                'attack_id': container_item[1],\n                'input_arguments': container_item[2],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[3]},\n            })\n\n    phantom.act(\"format command\", parameters=parameters, app={ \"name\": 'Atomic Red Team' }, callback=filter_1, name=\"Format_ART_Command\", parent_action=action)\n\n    return",
                        "custom_join": "",
                        "custom_name": "Format ART Command",
                        "delay": 0,
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "e29675fd-9f55-44ff-9301-8429275e8bcf",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 51,
                        "line_start": 25,
                        "message": "Configuring now",
                        "name": "format command",
                        "notes": "",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "Format_ART_Command",
                        "required_params": {
                            "attack_id": true,
                            "supported_os": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 713
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def filter_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_2() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Powershell_Test:action_result.data.*.status_code\", \"!=\", 0],\n        ],\n        name=\"filter_2:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        Post_Error_Msg(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Powershell_Test:action_result.data.*.status_code\", \"==\", 0],\n        ],\n        name=\"filter_2:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        join_Format_End_Marker(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Powershell Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def filter_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('filter_2() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Powershell_Test:action_result.data.*.status_code\", \"!=\", 0],\n        ],\n        name=\"filter_2:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        phantom.save_run_data(value='present', key='powershell_error', auto=True)\n        Post_Error_Msg(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    # collect filtered artifact ids for 'if' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Run_Powershell_Test:action_result.data.*.status_code\", \"==\", 0],\n        ],\n        name=\"filter_2:condition_2\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_2 or matched_results_2:\n        join_Format_End_Marker(action=action, success=success, container=container, results=results, handle=handle, filtered_artifacts=matched_artifacts_2, filtered_results=matched_results_2)\n\n    return",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "47ff0215-a04d-4da5-b786-3012ad5db0af",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 595,
                        "line_start": 563,
                        "name": "filter",
                        "notes": "",
                        "number": 2,
                        "order": 16,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "Run_Powershell_Test:action_result.data.*.status_code",
                                        "value": "0"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "Run_Powershell_Test:action_result.data.*.status_code",
                                        "value": "0"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1600,
                            "y": 60
                        },
                        "previous_function": "",
                        "previous_name": "filter_2",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 714
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "Format Start Marker"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_1() called')\n    \n    template = \"\"\"eventcreate /id 999 /D \\\"started test on {0} guid=\\\" /T INFORMATION /L application\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.destinationAddress\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_1\")\n\n    write_started_event(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Post Start Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Format_Start_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_1() called')\n    \n    playbook_info = phantom.get_playbook_info()\n    guid = phantom.get_data(playbook_info[0]['id'], clear_data=False)\n    \n    template = \"eventcreate /id 999 /D \\\"started test on {0} guid=%s\\\" /T INFORMATION /L application\" % guid\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.destinationAddress\"\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"Format_Start_Marker\")\n\n    Run_Start_Marker(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "Format Start Marker",
                        "description": "",
                        "format": "format",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d6141597-15a3-451a-ae6c-79bd83d15550",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 254,
                        "line_start": 235,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 1,
                        "order": 9,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.destinationAddress"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 520,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "Format_Start_Marker",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "eventcreate /id 999 /D \"started test on {0} guid=\" /T INFORMATION /L application",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 721
                    },
                    {
                        "action": "format command",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attack_id": "artifact:*.cef.act",
                            "input_arguments": "",
                            "supported_os": "linux"
                        },
                        "angle": 0,
                        "app": "Atomic Red Team",
                        "appid": "005e9bff-dfd2-40c8-9845-e32b438c2e93",
                        "approver": "",
                        "assets": [
                            {
                                "action": "format command",
                                "actions": [
                                    "get payload",
                                    "list modules",
                                    "get module",
                                    "format command",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Atomic Red Team",
                                "app_version": "1.0.0",
                                "appid": "005e9bff-dfd2-40c8-9845-e32b438c2e93",
                                "asset_name": "art_main_repo",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "attack_id": "artifact:*.cef.act",
                                    "input_arguments": "",
                                    "supported_os": "linux"
                                },
                                "has_app": true,
                                "id": 6,
                                "loaded": false,
                                "missing": false,
                                "name": "art_main_repo",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "Formatted Command",
                                        "column_order": 3,
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.executor.command",
                                        "data_type": "string",
                                        "example_values": [
                                            "cmd.exe /c \"net use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator\"\n",
                                            "regsvr32.exe /s /u /i:Regsvr32.sct scrobj.dll\n"
                                        ]
                                    },
                                    {
                                        "column_name": "Shell Type",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.executor.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "command_prompt"
                                        ]
                                    },
                                    {
                                        "column_name": "Attack ID",
                                        "column_order": 0,
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.data.*.attack_technique",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total tests: 1",
                                            "Total tests: 3"
                                        ]
                                    },
                                    {
                                        "column_name": "Supported OS",
                                        "column_order": 1,
                                        "data_path": "action_result.parameter.supported_os",
                                        "data_type": "string",
                                        "example_values": [
                                            "windows"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.parameter.attack_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total tests",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.executor.arg_types",
                                        "data_type": "string",
                                        "example_values": [
                                            "Path"
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "attack_id": {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "MITRE ATT@CK ID for technique (e.g. T1033)",
                                        "key": "attack_id",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "input_arguments": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "JSON of input arguments",
                                        "key": "input_arguments",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "supported_os": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "OS to format command for",
                                        "key": "supported_os",
                                        "order": 1,
                                        "primary": false,
                                        "required": true,
                                        "value_list": [
                                            "windows",
                                            "macos",
                                            "linux"
                                        ]
                                    }
                                },
                                "product_name": "Atomic Red Team",
                                "product_vendor": "Red Canary",
                                "targets": "6",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Format ART Linux Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Format_ART_Linux_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_ART_Linux_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Format_ART_Linux_Test' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.act', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'Format_ART_Linux_Test' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'supported_os': \"linux\",\n                'attack_id': container_item[0],\n                'input_arguments': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"format command\", parameters=parameters, assets=['art_main_repo'], callback=Run_ART_Linux_Test, name=\"Format_ART_Linux_Test\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Post Start Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Format ART Linux Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "271a5122-bfea-4368-8c37-677ff25f5e50",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 864,
                        "line_start": 839,
                        "message": "Configuring now",
                        "name": "format command",
                        "notes": "",
                        "number": 2,
                        "order": 25,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": 440
                        },
                        "previous_function": "",
                        "previous_name": "Format_ART_Linux_Test",
                        "required_params": {
                            "attack_id": true,
                            "supported_os": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 722
                    },
                    {
                        "action": "run script",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "async": "",
                            "command_id": "",
                            "ip_hostname": "artifact:*.cef.destinationAddress",
                            "parser": "",
                            "script_file": "",
                            "script_str": "format_1:formatted_data",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run script",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.20",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "async": "",
                                    "command_id": "",
                                    "ip_hostname": "artifact:*.cef.destinationAddress",
                                    "parser": "",
                                    "script_file": "",
                                    "script_str": "Format_Start_Marker:formatted_data",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 6,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_str",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_file": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a PowerShell script to run",
                                        "key": "script_file",
                                        "order": 1,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_str": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "A PowerShell script to run",
                                        "key": "script_str",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run Start Marker"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_Start_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_Start_Marker() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_Start_Marker' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationAddress', 'artifact:*.id'])\n    formatted_data_1 = phantom.get_format_data(name='Format_Start_Marker')\n\n    parameters = []\n    \n    # build parameters list for 'Run_Start_Marker' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'shell_id': \"\",\n                'parser': \"\",\n                'ip_hostname': container_item[0],\n                'async': \"\",\n                'script_str': formatted_data_1,\n                'script_file': \"\",\n                'command_id': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(\"run script\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=decision_4, name=\"Run_Start_Marker\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Post Start Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run Start Marker",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d10b425d-717c-478a-8fe3-c484a18ff770",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 333,
                        "line_start": 303,
                        "message": "Configuring now",
                        "name": "run script",
                        "notes": "",
                        "number": 2,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 520,
                            "y": 120
                        },
                        "previous_function": "",
                        "previous_name": "Run_Start_Marker",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 723
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "4b0b0168-b068-40f3-8a3e-d68b767bffa2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d10b425d-717c-478a-8fe3-c484a18ff770",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "fa4821a0-f2e5-480e-bb9b-15dedf109f2c",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 724
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 4
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_4(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('decision_4() called')\n\n    # check for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.playbook_name\", \"==\", \"Invoke Simulation\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched_artifacts_1 or matched_results_1:\n        format_invoke_cmd(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    # call connected blocks for 'else' condition 2\n    decision_3(action=action, success=success, container=container, results=results, handle=handle)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fa4821a0-f2e5-480e-bb9b-15dedf109f2c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 938,
                        "line_start": 917,
                        "name": "decision",
                        "notes": "",
                        "number": 4,
                        "order": 28,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.playbook_name",
                                        "value": "Invoke Simulation"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 780,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "decision_4",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 728
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7bf62fe0-db7e-496d-99dd-3dc5093238c1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fa4821a0-f2e5-480e-bb9b-15dedf109f2c",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "09a940ba-2076-43da-9fb6-47fca922f0ab",
                            "port": "in",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 729
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-2": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": -2
                            },
                            ".outPorts>.port-2>.port-body": {
                                "port": {
                                    "id": "out-3",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('decision_3() called')\n\n    # check for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.manual_command\", \"!=\", \"NA\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched_artifacts_1 or matched_results_1:\n        Run_Manual_Cmd(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    # check for 'elif' condition 2\n    matched_artifacts_2, matched_results_2 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.manual_powershell\", \"!=\", \"NA\"],\n        ])\n\n    # call connected blocks if condition 2 matched\n    if matched_artifacts_2 or matched_results_2:\n        Run_Manual_Powershell(action=action, success=success, container=container, results=results, handle=handle)\n        return\n\n    # call connected blocks for 'else' condition 3\n    Format_ART_Command(action=action, success=success, container=container, results=results, handle=handle)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "09a940ba-2076-43da-9fb6-47fca922f0ab",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 734,
                        "line_start": 700,
                        "name": "decision",
                        "notes": "",
                        "number": 3,
                        "order": 20,
                        "outPorts": [
                            "out-1",
                            "out-2",
                            "out-3"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.manual_command",
                                        "value": "NA"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.manual_powershell",
                                        "value": "NA"
                                    }
                                ],
                                "display": "Else If",
                                "logic": "and",
                                "type": "elif"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 820,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "decision_3",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 730
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "c9fc3516-2ed2-49be-9842-385fee65620e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "1afa9143-6c8f-44bd-8867-cd66eb541da4",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "84d8cf57-de36-483e-bb67-6631cfc4eef9",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 731
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7221278f-da89-46db-b0a0-ed14add395f3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "e940c571-b417-40c2-adff-1359fd944c38",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "84d8cf57-de36-483e-bb67-6631cfc4eef9",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 732
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "Format End Marker"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_2() called')\n    \n    template = \"\"\"eventcreate /id 999 /D \\\"ended test for {0}\\\" /T INFORMATION /L application\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"write_started_event:action_result.parameter.ip_hostname\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_2\")\n\n    write_ended_event(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Manual Cmd, Post Error Msg, Run Powershell Test, Post Error Msg 2, Run Cmd Test, Run Manual Powershell, invoke ART cmd",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "def Format_End_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_End_Marker() called')\n    \n    playbook_info = phantom.get_playbook_info()\n    guid = phantom.get_data(playbook_info[0]['id'], clear_data=False)\n    phantom.debug(guid)\n        \n    template = \"eventcreate /id 999 /D \\\"ended test for {0} guid=%s\\\" /T INFORMATION /L application\" % guid\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"Run_Start_Marker:action_result.parameter.ip_hostname\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"Format_End_Marker\")\n\n    Run_End_Marker(container=container)\n\n    return",
                        "custom_join": "def join_Format_End_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('join_Format_End_Marker() called')\n    \n    # if the joined function has already been called, do nothing\n    if phantom.get_run_data(key='join_Format_End_Marker_called'):\n        return\n    \n    if phantom.actions_done(['Run_ART_MacOS_Test']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n        \n    if phantom.actions_done(['Run_ART_Linux_Test']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n    \n    if phantom.actions_done(['invoke_ART_cmd']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n        \n    if phantom.actions_done(['Run_Scythe_Campaign']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n        \n    if phantom.actions_done(['Run_Manual_Cmd']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n        \n    elif phantom.actions_done(['Run_Manual_Powershell']):\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        Format_End_Marker(container=container, handle=handle)\n\n    elif phantom.get_run_data(key='powershell_test') and phantom.get_run_data(key='cmd_test'):\n        if phantom.get_run_data(key='powershell_error') and phantom.get_run_data(key='cmd_error'):\n            if phantom.actions_done([ 'Post_Error_Msg', 'Post_Error_Msg_2' ]):\n                phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n                # call connected block \"Format_End_Marker\"\n                Format_End_Marker(container=container, handle=handle)\n        elif phantom.get_run_data(key='cmd_error'): \n            if phantom.actions_done([ 'Post_Error_Msg_2', 'Run_Powershell_Test']):\n                phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n                # call connected block \"Format_End_Marker\"\n                Format_End_Marker(container=container, handle=handle)\n        elif phantom.get_run_data(key='powershell_error'): \n            if phantom.actions_done([ 'Post_Error_Msg', 'Run_Cmd_Test' ]):\n                phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n                # call connected block \"Format_End_Marker\"\n                Format_End_Marker(container=container, handle=handle)\n        elif phantom.actions_done([ 'Run_Powershell_Test', 'Run_Cmd_Test' ]):\n                phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n                # call connected block \"Format_End_Marker\"\n                Format_End_Marker(container=container, handle=handle)\n                \n    elif phantom.get_run_data(key='powershell_test'):\n        if phantom.get_run_data(key='powershell_error') and phantom.actions_done([ 'Post_Error_Msg' ]):\n            phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n            # call connected block \"Format_End_Marker\"\n            Format_End_Marker(container=container, handle=handle)\n            \n        elif phantom.actions_done([ 'Run_Powershell_Test' ]):\n            phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n            # call connected block \"Format_End_Marker\"\n            Format_End_Marker(container=container, handle=handle)\n            \n    elif phantom.get_run_data(key='cmd_test'):\n        if phantom.get_run_data(key='cmd_error') and phantom.actions_done([ 'Post_Error_Msg_2' ]):\n            phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n            # call connected block \"Format_End_Marker\"\n            Format_End_Marker(container=container, handle=handle)\n            \n        elif phantom.actions_done([ 'Run_Cmd_Test' ]):\n            phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n            # call connected block \"Format_End_Marker\"\n            Format_End_Marker(container=container, handle=handle)\n\n    return",
                        "custom_name": "Format End Marker",
                        "description": "",
                        "format": "format",
                        "has_custom": true,
                        "has_custom_block": true,
                        "has_custom_callback": false,
                        "has_custom_join": true,
                        "id": "4607ee03-c437-4903-9d01-cbff02ae611d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_Format_End_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('join_Format_End_Marker() called')\n    \n    # if the joined function has already been called, do nothing\n    if phantom.get_run_data(key='join_Format_End_Marker_called'):\n        return\n\n    # check if all connected incoming actions are done i.e. have succeeded or failed\n    if phantom.actions_done([ 'Post_Error_Msg', 'Post_Error_Msg_2' ]):\n        \n        # save the state that the joined function has now been called\n        phantom.save_run_data(key='join_Format_End_Marker_called', value='Format_End_Marker')\n        \n        # call connected block \"Format_End_Marker\"\n        Format_End_Marker(container=container, handle=handle)\n    \n    return",
                        "join_optional": [
                            "Run_Cmd_Test"
                        ],
                        "join_start": 446,
                        "line_end": 530,
                        "line_start": 426,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 2,
                        "order": 14,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "Run_Start_Marker:action_result.parameter.ip_hostname"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2000,
                            "y": 300
                        },
                        "previous_function": "",
                        "previous_name": "Format_End_Marker",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "eventcreate /id 999 /D \"ended test for {0}\" /T INFORMATION /L application",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 734
                    },
                    {
                        "action": "run script",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "async": "",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                            "parser": "",
                            "script_file": "",
                            "script_str": "Format_End_Marker:formatted_data",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run script",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.19",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "async": "",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:action_result.parameter.ip_hostname",
                                    "parser": "",
                                    "script_file": "",
                                    "script_str": "Format_End_Marker:formatted_data",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 36,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_str",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_file": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a PowerShell script to run",
                                        "key": "script_file",
                                        "order": 1,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_str": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "A PowerShell script to run",
                                        "key": "script_str",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run End Marker"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_End_Marker(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_End_Marker() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_End_Marker' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:action_result.parameter.ip_hostname', 'Run_Start_Marker:action_result.parameter.context.artifact_id'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='Format_End_Marker')\n\n    parameters = []\n    \n    # build parameters list for 'Run_End_Marker' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'shell_id': \"\",\n                'parser': \"\",\n                'ip_hostname': results_item_1[0],\n                'async': \"\",\n                'script_str': formatted_data_1,\n                'script_file': \"\",\n                'command_id': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(\"run script\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=join_Format_End_Event, name=\"Run_End_Marker\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Manual Cmd, Post Error Msg, Run Powershell Test, Post Error Msg 2, Run Cmd Test, Run Manual Powershell, invoke ART cmd",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run End Marker",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "21ef810d-17ff-4190-a30b-49982453db83",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 143,
                        "line_start": 113,
                        "message": "Configuring now",
                        "name": "run script",
                        "notes": "",
                        "number": 3,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2020,
                            "y": 160
                        },
                        "previous_function": "",
                        "previous_name": "Run_End_Marker",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 735
                    },
                    {
                        "action": "format command",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attack_id": "Post_Start_Event_to_Splunk:artifact:*.cef.act",
                            "input_arguments": "",
                            "supported_os": "macos"
                        },
                        "angle": 0,
                        "app": "Atomic Red Team",
                        "appid": "005e9bff-dfd2-40c8-9845-e32b438c2e93",
                        "approver": "",
                        "assets": [
                            {
                                "action": "format command",
                                "active": true,
                                "app_name": "Atomic Red Team",
                                "app_version": "1.0.0",
                                "appid": "005e9bff-dfd2-40c8-9845-e32b438c2e93",
                                "config_type": "app",
                                "fields": {
                                    "attack_id": "Post_Start_Event_to_Splunk:artifact:*.cef.act",
                                    "input_arguments": "",
                                    "supported_os": "macos"
                                },
                                "has_app": true,
                                "id": 51,
                                "loaded": false,
                                "missing": false,
                                "name": "Atomic Red Team",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "Formatted Command",
                                        "column_order": 3,
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.executor.command",
                                        "data_type": "string",
                                        "example_values": [
                                            "cmd.exe /c \"net use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator\"\n",
                                            "regsvr32.exe /s /u /i:Regsvr32.sct scrobj.dll\n"
                                        ]
                                    },
                                    {
                                        "column_name": "Shell Type",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.executor.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "command_prompt"
                                        ]
                                    },
                                    {
                                        "column_name": "Attack ID",
                                        "column_order": 0,
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.data.*.attack_technique",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total tests: 1",
                                            "Total tests: 3"
                                        ]
                                    },
                                    {
                                        "column_name": "Supported OS",
                                        "column_order": 1,
                                        "data_path": "action_result.parameter.supported_os",
                                        "data_type": "string",
                                        "example_values": [
                                            "windows"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_path": "action_result.parameter.attack_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1077",
                                            "T1117"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total tests",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.executor.arg_types",
                                        "data_type": "string",
                                        "example_values": [
                                            "Path"
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "attack_id": {
                                        "contains": [
                                            "mitre attack id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "MITRE ATT@CK ID for technique (e.g. T1033)",
                                        "key": "attack_id",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "input_arguments": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "JSON of input arguments",
                                        "key": "input_arguments",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "supported_os": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "OS to format command for",
                                        "key": "supported_os",
                                        "order": 1,
                                        "primary": false,
                                        "required": true,
                                        "value_list": [
                                            "windows",
                                            "macos",
                                            "linux"
                                        ]
                                    }
                                },
                                "product_name": "Atomic Red Team",
                                "product_vendor": "Red Canary",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Format ART MacOS Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Format_ART_MacOS_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_ART_MacOS_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Format_ART_MacOS_Test' call\n    inputs_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:artifact:*.cef.act', 'Post_Start_Event_to_Splunk:artifact:*.id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Format_ART_MacOS_Test' call\n    for inputs_item_1 in inputs_data_1:\n        if inputs_item_1[0]:\n            parameters.append({\n                'supported_os': \"macos\",\n                'attack_id': inputs_item_1[0],\n                'input_arguments': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': inputs_item_1[1]},\n            })\n\n    phantom.act(\"format command\", parameters=parameters, app={ \"name\": 'Atomic Red Team' }, callback=Run_ART_MacOS_Test, name=\"Format_ART_MacOS_Test\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Post Start Event to Splunk",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Format ART MacOS Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "cdf1228b-0dc1-4492-89d6-1d2c553b2365",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 889,
                        "line_start": 864,
                        "message": "Configuring now",
                        "name": "format command",
                        "notes": "",
                        "number": 3,
                        "order": 26,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": -200
                        },
                        "previous_function": "",
                        "previous_name": "Format_ART_MacOS_Test",
                        "required_params": {
                            "attack_id": true,
                            "supported_os": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 736
                    },
                    {
                        "action": "run script",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "async": "False",
                            "command_id": "",
                            "ip_hostname": "Run_Start_Marker:artifact:*.cef.destinationAddress",
                            "parser": "",
                            "script_file": "",
                            "script_str": "format_invoke_cmd:formatted_data",
                            "shell_id": ""
                        },
                        "angle": 0,
                        "app": "Windows Remote Management",
                        "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run script",
                                "active": true,
                                "app_name": "Windows Remote Management",
                                "app_version": "1.0.20",
                                "appid": "a0222b95-b006-4c9e-9578-1428defcec0f",
                                "config_type": "app",
                                "fields": {
                                    "async": "False",
                                    "command_id": "",
                                    "ip_hostname": "Run_Start_Marker:artifact:*.cef.destinationAddress",
                                    "parser": "",
                                    "script_file": "",
                                    "script_str": "format_invoke_cmd:formatted_data",
                                    "shell_id": ""
                                },
                                "has_app": true,
                                "id": 6,
                                "loaded": false,
                                "missing": false,
                                "name": "Windows Remote Management",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.async",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.parameter.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.parser",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_str",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.parameter.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.status_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_err",
                                        "data_type": "string",
                                        "example_values": [
                                            "Error message"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.std_out",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successful output"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_path": "action_result.summary.command_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_path": "action_result.summary.shell_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "async": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Start the command, but don't wait for output",
                                        "key": "async",
                                        "order": 4,
                                        "required": false
                                    },
                                    "command_id": {
                                        "contains": [
                                            "winrm command id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command ID of async command (Provide with shell_id)",
                                        "key": "command_id",
                                        "order": 5,
                                        "primary": true,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP/Hostname",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "required": true
                                    },
                                    "parser": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a custom parser to use for output",
                                        "key": "parser",
                                        "order": 3,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_file": {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "The vault ID of a PowerShell script to run",
                                        "key": "script_file",
                                        "order": 1,
                                        "primary": true,
                                        "required": false
                                    },
                                    "script_str": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "A PowerShell script to run",
                                        "key": "script_str",
                                        "order": 2,
                                        "primary": true,
                                        "required": false
                                    },
                                    "shell_id": {
                                        "contains": [
                                            "winrm shell id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Shell ID of async command (Provide with command_id)",
                                        "key": "shell_id",
                                        "order": 6,
                                        "required": false
                                    }
                                },
                                "product_name": "Windows Remote Management",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "invoke ART cmd"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def invoke_ART_cmd(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('invoke_ART_cmd() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'invoke_ART_cmd' call\n    inputs_data_1 = phantom.collect2(container=container, datapath=['Run_Start_Marker:artifact:*.cef.destinationAddress', 'Run_Start_Marker:artifact:*.id'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='format_invoke_cmd')\n\n    parameters = []\n    \n    # build parameters list for 'invoke_ART_cmd' call\n    for inputs_item_1 in inputs_data_1:\n        if inputs_item_1[0]:\n            parameters.append({\n                'shell_id': \"\",\n                'parser': \"\",\n                'ip_hostname': inputs_item_1[0],\n                'async': False,\n                'script_str': formatted_data_1,\n                'script_file': \"\",\n                'command_id': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': inputs_item_1[1]},\n            })\n\n    phantom.act(\"run script\", parameters=parameters, app={ \"name\": 'Windows Remote Management' }, callback=join_Format_End_Marker, name=\"invoke_ART_cmd\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "invoke ART cmd",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "cd5573a4-4cff-40d6-af38-f9508e4dc7cc",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 811,
                        "line_start": 781,
                        "message": "Configuring now",
                        "name": "run script",
                        "notes": "",
                        "number": 6,
                        "order": 23,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1740,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "invoke_ART_cmd",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 738
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "Format End Event"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Format_End_Event(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Format_End_Event() called')\n    \n    template = \"\"\"Finished red team test: {0}  on machine with IP address: {1}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.act\",\n        \"artifact:*.cef.destinationAddress\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"Format_End_Event\")\n\n    Post_End_Event_to_Splunk(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run End Marker, Run ART MacOS Test, Run ART Linux Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Format End Event",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "84d8cf57-de36-483e-bb67-6631cfc4eef9",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_Format_End_Event(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('join_Format_End_Event() called')\n    \n    # if the joined function has already been called, do nothing\n    if phantom.get_run_data(key='join_Format_End_Event_called'):\n        return\n\n    # no callbacks to check, call connected block \"Format_End_Event\"\n    phantom.save_run_data(key='join_Format_End_Event_called', value='Format_End_Event', auto=True)\n\n    Format_End_Event(container=container, handle=handle)\n    \n    return",
                        "join_optional": [
                            "Run_End_Marker",
                            "Run_ART_MacOS_Test",
                            "Run_ART_Linux_Test"
                        ],
                        "join_start": 99,
                        "line_end": 113,
                        "line_start": 82,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 4,
                        "order": 4,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.act"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "artifact:*.cef.destinationAddress"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2280,
                            "y": 160
                        },
                        "previous_function": "",
                        "previous_name": "Format_End_Event",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Finished red team test: {0}  on machine with IP address: {1}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 746
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "3cdb841a-a698-4459-9350-b23a9688cc94",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fa4821a0-f2e5-480e-bb9b-15dedf109f2c",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "73edf05d-71cf-4a86-b83e-4b7b89b8e1a0",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 747
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format invoke cmd"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_invoke_cmd(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_invoke_cmd() called')\n    \n    template = \"\"\"Import-Module \\\"C:\\\\AtomicRedTeam\\\\invoke-atomicredteam\\\\Invoke-AtomicRedTeam.psm1\\\"; Invoke-AtomicTest {0} -PathToAtomicsFolder \\\"C:\\\\AtomicRedTeam\\\\atomics\\\"\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.act\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_invoke_cmd\")\n\n    invoke_ART_cmd(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "Run Start Marker",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format invoke cmd",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "73edf05d-71cf-4a86-b83e-4b7b89b8e1a0",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 781,
                        "line_start": 765,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Note: requires you to have installed ART on the target host with the following command: IEX (IWR 'https://raw.githubusercontent.com/redcanaryco/invoke-atomicredteam/master/install-atomicredteam.ps1' -UseBasicParsing); Install-AtomicRedTeam -getAtomics",
                        "number": 5,
                        "order": 22,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "artifact:*.cef.act"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1280,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "format_invoke_cmd",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Import-Module \"C:\\AtomicRedTeam\\invoke-atomicredteam\\Invoke-AtomicRedTeam.psm1\"; Invoke-AtomicTest {0} -PathToAtomicsFolder \"C:\\AtomicRedTeam\\atomics\"",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 748
                    },
                    {
                        "action": "execute program",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "command": "Format_ART_Linux_Test:action_result.data.*.executor.command",
                            "ip_hostname": "Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress",
                            "script_file": "",
                            "timeout": ""
                        },
                        "angle": 0,
                        "app": "SSH",
                        "appid": "d37aa7fe-c973-44ee-a164-2ca5bf321b1f",
                        "approver": "",
                        "assets": [
                            {
                                "action": "execute program",
                                "active": true,
                                "app_name": "SSH",
                                "app_version": "1.0.47",
                                "appid": "d37aa7fe-c973-44ee-a164-2ca5bf321b1f",
                                "config_type": "app",
                                "fields": {
                                    "command": "Format_ART_Linux_Test:action_result.data.*.executor.command",
                                    "ip_hostname": "Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress",
                                    "script_file": "",
                                    "timeout": ""
                                },
                                "has_app": true,
                                "id": 37,
                                "loaded": false,
                                "missing": false,
                                "name": "SSH",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_path": "action_result.parameter.ip_hostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.script_file",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.timeout",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.output",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.exit_status",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "command": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Command to be executed on endpoint",
                                        "key": "command",
                                        "order": 1,
                                        "required": false
                                    },
                                    "ip_hostname": {
                                        "contains": [
                                            "ip",
                                            "host name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Hostname/IP to execute command on",
                                        "key": "ip_hostname",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "script_file": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Local path to shell script",
                                        "key": "script_file",
                                        "order": 2,
                                        "required": false
                                    },
                                    "timeout": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Seconds before timeout (Default: 60)",
                                        "key": "timeout",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "SSH",
                                "product_vendor": "Generic",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "Run ART Linux Test"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def Run_ART_Linux_Test(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('Run_ART_Linux_Test() called')\n    \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'Run_ART_Linux_Test' call\n    results_data_1 = phantom.collect2(container=container, datapath=['Format_ART_Linux_Test:action_result.data.*.executor.command', 'Format_ART_Linux_Test:action_result.parameter.context.artifact_id'], action_results=results)\n    inputs_data_1 = phantom.collect2(container=container, datapath=['Post_Start_Event_to_Splunk:artifact:*.cef.destinationAddress', 'Post_Start_Event_to_Splunk:artifact:*.id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'Run_ART_Linux_Test' call\n    for results_item_1 in results_data_1:\n        for inputs_item_1 in inputs_data_1:\n            if inputs_item_1[0]:\n                parameters.append({\n                    'command': results_item_1[0],\n                    'ip_hostname': inputs_item_1[0],\n                    'timeout': \"\",\n                    'script_file': \"\",\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(\"execute program\", parameters=parameters, app={ \"name\": 'SSH' }, callback=join_Format_End_Event, name=\"Run_ART_Linux_Test\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "Format ART Linux Test",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "Run ART Linux Test",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "e940c571-b417-40c2-adff-1359fd944c38",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 839,
                        "line_start": 811,
                        "message": "Configuring now",
                        "name": "execute program",
                        "notes": "",
                        "number": 1,
                        "order": 24,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2000,
                            "y": 440
                        },
                        "previous_function": "",
                        "previous_name": "Run_ART_Linux_Test",
                        "required_params": {
                            "ip_hostname": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_app_config",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 749
                    }
                ]
            },
            "notes": ""
        },
        "schema": 3,
        "version": "4.6.18265"
    },
    "create_time": "2020-07-08T14:18:43.764795+00:00",
    "draft_mode": false,
    "labels": [
        "advsim_test"
    ],
    "tags": []
}